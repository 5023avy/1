<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<form id="__cqu5flKjT8E35djAmXY">
  <name>股权架构信息_表格显示</name>
  <parentId>__mJfQDLm8NzwJoki8LOL</parentId>
  <description></description>
  <templatecontext><![CDATA[<div draggable="true" name="容器1" id="c35b2551-5f3e-0ad9-13af-c307960090f6" scope="formPanel" class="" data-empty-tip="从左侧拖拽来添加控件" nameindex="41" myselfrows="100" containerheight="100" borderwidth="1" containerwidth="500" style="height: 100%; border: none rgb(255, 255, 255); padding: 20px 20px 40px; overflow: hidden; margin: 0px auto; background-color: rgb(255, 255, 255);"><div name="标题" id="e922a144-0933-62a9-9815-63f4a93218d6" draggable="true" scope="calctextField" myselfrows="100" layout="horizontal" calculateonrefresh="false" valuescript="" style="display: inline-block; width: 100%; border-left: 5px solid rgb(255, 255, 255); border-top-color: rgb(255, 255, 255); border-right-color: rgb(255, 255, 255); border-bottom-color: rgb(255, 255, 255); background-color: rgb(255, 255, 255); position: relative; vertical-align: top;"><div style="padding: 5px 0;line-height: 20px;color: #3d464d;font-weight: 600;">
        <span class="baseLabel-title" style="font-size: 14px;color: #3d464d;">标题</span>
        </div><div class="baseCon fieldId" fieldid="e922a144-0933-62a9-9815-63f4a93218d6" style="height: 30px;">
        <img src="images/calctextField.png"></div><div class="delete d-none"><i class="btn-delete" title="删除"></i></div></div><div name="表格显示" id="1ba7ccc7-4d25-f658-c76c-d7d2e98a2ea0" draggable="true" scope="calctextField" myselfrows="100" layout="horizontal" calculateonrefresh="true" valuescript="(function()@nbsp;{&#13;@nbsp;@nbsp;@nbsp;@nbsp;//@nbsp;查询数据库表格数据&#13;@nbsp;@nbsp;@nbsp;@nbsp;var@nbsp;sql@nbsp;=@nbsp;@quot;SELECT@nbsp;*@nbsp;FROM@nbsp;tlk_组织架构显示基础数据@nbsp;ORDER@nbsp;BY@nbsp;item_序号@quot;;&#13;@nbsp;@nbsp;@nbsp;@nbsp;var@nbsp;query@nbsp;=@nbsp;queryBySQL(sql);&#13;@nbsp;@nbsp;@nbsp;@nbsp;var@nbsp;level@nbsp;=@nbsp;[@quot;一@quot;,@quot;二@quot;,@quot;三@quot;,@quot;四@quot;,@quot;五@quot;,@quot;六@quot;,@quot;七@quot;];&#13;&#13;@nbsp;@nbsp;@nbsp;@nbsp;var@nbsp;dataDict@nbsp;=@nbsp;[];&#13;@nbsp;@nbsp;@nbsp;@nbsp;var@nbsp;NoSubCompanyMap@nbsp;=@nbsp;{}@nbsp;//存放不存在下级的公司的级次&#13;@nbsp;@nbsp;@nbsp;@nbsp;var@nbsp;ctrlMap@nbsp;=@nbsp;{}@nbsp;//存放公司控股比例&#13;&#13;@nbsp;@nbsp;@nbsp;@nbsp;if@nbsp;(query@nbsp;!=@nbsp;null)@nbsp;{&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;//@nbsp;遍历查询结果，将数据存储在dataDict数组中&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;var@nbsp;iter@nbsp;=@nbsp;query.iterator();&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;while@nbsp;(iter.hasNext())@nbsp;{&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;var@nbsp;doc@nbsp;=@nbsp;iter.next();&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;var@nbsp;d1@nbsp;=@nbsp;{&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@quot;企业名称@quot;:@nbsp;doc.getItemValueAsString(@quot;企业名称@quot;),&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@quot;级次@quot;:@nbsp;doc.getItemValueAsString(@quot;级次@quot;),&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@quot;上级企业@quot;:@nbsp;doc.getItemValueAsString(@quot;上级企业@quot;),&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;number:doc.getItemValueAsInt(@quot;序号@quot;)&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;};&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;var@nbsp;ctrl@nbsp;=@nbsp;doc.getItemValueAsString(@quot;控股比例@quot;);&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;if@nbsp;(ctrl)@nbsp;{&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;ctrlMap[d1[@quot;企业名称@quot;]]=ctrl+@quot;%@quot;;&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;}&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;else{&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;ctrlMap[d1[@quot;企业名称@quot;]]=@quot;@quot;;&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;}&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;for@nbsp;(var@nbsp;i=0;i@lt;7;i++){&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;if@nbsp;(d1[@quot;级次@quot;].indexOf(level[i])!=-1){&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;NoSubCompanyMap[d1[@quot;企业名称@quot;]]=i+1;&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;break;&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;}&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;}&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;dataDict.push(d1);&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;}&#13;&#13;&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;//@nbsp;构建公司名字与其上级公司名字的映射关系&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;var@nbsp;companyMap@nbsp;=@nbsp;{};&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;for@nbsp;(var@nbsp;i@nbsp;=@nbsp;0;@nbsp;i@nbsp;@lt;@nbsp;dataDict.length;@nbsp;i++)@nbsp;{&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;var@nbsp;row@nbsp;=@nbsp;dataDict[i];&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;var@nbsp;companyName@nbsp;=@nbsp;row[@quot;企业名称@quot;];&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;var@nbsp;superiorCompany@nbsp;=@nbsp;row[@quot;上级企业@quot;];&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;if@nbsp;(!companyMap[companyName])@nbsp;{&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;companyMap[companyName]@nbsp;=@nbsp;[];&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;}&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;if@nbsp;(superiorCompany)@nbsp;{&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;companyMap[companyName].unshift(superiorCompany);@nbsp;//@nbsp;使用unshift将上级公司添加到列表的开头&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;//@nbsp;将上级公司的上级公司也加入映射关系中&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;if@nbsp;(companyMap[superiorCompany])@nbsp;{&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;companyMap[companyName]@nbsp;=@nbsp;companyMap[companyName].concat(companyMap[superiorCompany]);&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;delete@nbsp;NoSubCompanyMap[superiorCompany];&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;}&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;}&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;}&#13;&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;//@nbsp;输出映射关系，格式为[[上级公司1,@nbsp;上级公司2,@nbsp;...,@nbsp;公司名1],@nbsp;[上级公司1,@nbsp;上级公司2,@nbsp;...,@nbsp;公司名2],@nbsp;...]&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;var@nbsp;dataArray@nbsp;=@nbsp;[];&#13;&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;//@nbsp;遍历原始的@nbsp;dataDict@nbsp;数组，按照原始顺序构建@nbsp;orderedDataArray&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;for@nbsp;(var@nbsp;i@nbsp;=@nbsp;0;@nbsp;i@nbsp;@lt;@nbsp;dataDict.length;@nbsp;i++)@nbsp;{&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;var@nbsp;row@nbsp;=@nbsp;dataDict[i];&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;var@nbsp;companyName@nbsp;=@nbsp;row[@quot;企业名称@quot;];&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;var@nbsp;hierarchy@nbsp;=@nbsp;companyMap[companyName];&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;hierarchy.pop();&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;hierarchy=hierarchy.reverse();&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;//println(hierarchy[0]);&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;hierarchy.push(companyName);@nbsp;//@nbsp;将公司名添加到列表的末尾&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;dataArray.push(hierarchy);&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;}&#13;&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;//@nbsp;输出结果&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;var@nbsp;formattedArray@nbsp;=@nbsp;@quot;var@nbsp;data@nbsp;=@nbsp;[\n@quot;;&#13;&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;for@nbsp;(var@nbsp;i@nbsp;=@nbsp;0;@nbsp;i@nbsp;@lt;@nbsp;dataArray.length;@nbsp;i++)@nbsp;{&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;var@nbsp;row@nbsp;=@nbsp;dataArray[i];&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;//@nbsp;将最上级公司放在最前面&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;//row@nbsp;=@nbsp;row.reverse();&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;var@nbsp;formattedRow@nbsp;=@nbsp;@quot;@nbsp;@nbsp;@nbsp;@nbsp;[@quot;@nbsp;+@nbsp;row.map(function(item)@nbsp;{&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;return@nbsp;typeof@nbsp;item@nbsp;===@nbsp;@quot;string@quot;||@quot;object@quot;@nbsp;?@nbsp;@quot;\@quot;@quot;@nbsp;+@nbsp;item@nbsp;+@nbsp;@quot;\@quot;@quot;@nbsp;:@nbsp;item;&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;}).join(@quot;,@nbsp;@quot;)@nbsp;+@nbsp;@quot;]@quot;;&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;formattedArray@nbsp;+=@nbsp;formattedRow;&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;if@nbsp;(i@nbsp;@lt;@nbsp;dataArray.length@nbsp;-@nbsp;1)@nbsp;{&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;formattedArray@nbsp;+=@nbsp;@quot;,@quot;;&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;}&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;formattedArray@nbsp;+=@nbsp;@quot;\n@quot;;&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;}&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;formattedArray@nbsp;+=@nbsp;@quot;];\n@quot;;&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;//println(formattedArray);&#13;@nbsp;@nbsp;@nbsp;@nbsp;}&#13;@nbsp;@nbsp;@nbsp;@nbsp;//级次Map转换为string&#13;@nbsp;@nbsp;@nbsp;@nbsp;var@nbsp;dictString@nbsp;=@nbsp;@quot;var@nbsp;NoSubCompanyMap@nbsp;=@nbsp;{@quot;;&#13;@nbsp;@nbsp;@nbsp;@nbsp;for@nbsp;(var@nbsp;key@nbsp;in@nbsp;NoSubCompanyMap)@nbsp;{&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;if@nbsp;(NoSubCompanyMap.hasOwnProperty(key))@nbsp;{&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;dictString@nbsp;+=@nbsp;@#146;@quot;@#146;@nbsp;+@nbsp;key@nbsp;+@nbsp;@#146;@quot;:@nbsp;@#146;@nbsp;+@nbsp;NoSubCompanyMap[key]@nbsp;+@nbsp;@#146;,@nbsp;@#146;;&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;}&#13;@nbsp;@nbsp;@nbsp;@nbsp;}&#13;@nbsp;@nbsp;@nbsp;@nbsp;//移除最后一个逗号和空格&#13;@nbsp;@nbsp;@nbsp;@nbsp;dictString@nbsp;=@nbsp;dictString.slice(0,@nbsp;-2);&#13;@nbsp;@nbsp;@nbsp;@nbsp;dictString@nbsp;+=@nbsp;@quot;};@quot;;&#13;&#13;@nbsp;@nbsp;@nbsp;@nbsp;//拼接链接&#13;@nbsp;@nbsp;@nbsp;@nbsp;var@nbsp;request@nbsp;=@nbsp;getParamsTable().getHttpRequest();&#13;@nbsp;@nbsp;@nbsp;@nbsp;//var@nbsp;userId@nbsp;=@nbsp;getWebUser().getId();&#13;@nbsp;@nbsp;@nbsp;@nbsp;//var@nbsp;Security@nbsp;=@nbsp;new@nbsp;Packages.cn.myapps.common.util.Security();&#13;@nbsp;@nbsp;@nbsp;@nbsp;//var@nbsp;token@nbsp;=@nbsp;Security.getToken(userId);&#13;@nbsp;@nbsp;@nbsp;@nbsp;var@nbsp;schema@nbsp;=@nbsp;request.getScheme();&#13;@nbsp;@nbsp;@nbsp;@nbsp;var@nbsp;docId@nbsp;=@nbsp;getId();&#13;@nbsp;@nbsp;@nbsp;@nbsp;var@nbsp;selectId@nbsp;=@nbsp;getParameter(@quot;_selects@quot;);&#13;@nbsp;@nbsp;@nbsp;@nbsp;var@nbsp;serverName@nbsp;=@nbsp;request.getServerName();&#13;@nbsp;@nbsp;@nbsp;@nbsp;var@nbsp;port@nbsp;=@nbsp;request.getServerPort();&#13;@nbsp;@nbsp;@nbsp;@nbsp;var@nbsp;requestUrl@nbsp;=schema+@quot;://@quot;+serverName;&#13;@nbsp;@nbsp;@nbsp;@nbsp;var@nbsp;appId@nbsp;=@nbsp;getApplication();&#13;@nbsp;@nbsp;@nbsp;@nbsp;var@nbsp;formId=@quot;__goBsOFp5lEYiwNUUdF3@quot;;&#13;@nbsp;@nbsp;@nbsp;@nbsp;&#13;&#13;@nbsp;@nbsp;@nbsp;@nbsp;var@nbsp;urlMap@nbsp;=@nbsp;{}&#13;@nbsp;@nbsp;@nbsp;@nbsp;for@nbsp;(var@nbsp;i@nbsp;=@nbsp;0;@nbsp;i@nbsp;@lt;@nbsp;dataDict.length;@nbsp;i++)@nbsp;{&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;var@nbsp;row@nbsp;=@nbsp;dataDict[i];&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;var@nbsp;companyName@nbsp;=@nbsp;row[@quot;企业名称@quot;];&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;var@nbsp;sqlURL@nbsp;=@nbsp;@quot;SELECT@nbsp;*@nbsp;FROM@nbsp;tlk_企业基础信息总览@nbsp;where@nbsp;item_单位名称=@#146;@quot;+companyName+@quot;@#146;@quot;;//缺最新&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;var@nbsp;queryURL@nbsp;=@nbsp;queryBySQL(sqlURL);&#13;@nbsp;@nbsp;@nbsp;@nbsp;&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;if@nbsp;(queryURL@nbsp;!=@nbsp;null)@nbsp;{&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;var@nbsp;iter@nbsp;=@nbsp;queryURL.iterator();&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;while@nbsp;(iter.hasNext())@nbsp;{&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;var@nbsp;doc@nbsp;=@nbsp;iter.next();&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;var@nbsp;docId@nbsp;=@nbsp;doc.getId();&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;var@nbsp;url=@quot;/static/portal/vue/index.html%23/open?appId=@quot;+appId+@quot;&amp;linkType=00&amp;actionContent=@quot;+formId+@quot;&amp;docid=@quot;+docId+@quot;&amp;isRefresh=true&amp;TaskId=@quot;+selectId+@quot;&amp;dialogWidth=500px&amp;dialogHeight=50px@quot;;&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;var@nbsp;urlLink@nbsp;=requestUrl+url;&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;urlMap[companyName]=urlLink;&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;}&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;}&#13;@nbsp;@nbsp;@nbsp;@nbsp;}&#13;@nbsp;@nbsp;@nbsp;@nbsp;//Url转换为string&#13;@nbsp;@nbsp;@nbsp;@nbsp;var@nbsp;urlString@nbsp;=@nbsp;@quot;var@nbsp;urls@nbsp;=@nbsp;{@quot;;&#13;@nbsp;@nbsp;@nbsp;@nbsp;for@nbsp;(var@nbsp;key@nbsp;in@nbsp;urlMap)@nbsp;{&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;if@nbsp;(urlMap.hasOwnProperty(key))@nbsp;{&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;urlString@nbsp;+=@nbsp;@#146;@quot;@#146;@nbsp;+@nbsp;key@nbsp;+@nbsp;@#146;@quot;:@nbsp;@quot;@#146;@nbsp;+@nbsp;urlMap[key]@nbsp;+@nbsp;@#146;@quot;,@nbsp;@#146;;&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;}&#13;@nbsp;@nbsp;@nbsp;@nbsp;}&#13;@nbsp;@nbsp;@nbsp;@nbsp;//移除最后一个逗号和空格&#13;@nbsp;@nbsp;@nbsp;@nbsp;urlString@nbsp;=@nbsp;urlString.slice(0,@nbsp;-2);&#13;@nbsp;@nbsp;@nbsp;@nbsp;urlString@nbsp;+=@nbsp;@quot;};@quot;;&#13;&#13;@nbsp;@nbsp;@nbsp;@nbsp;//控股信息转换为string&#13;@nbsp;@nbsp;@nbsp;@nbsp;var@nbsp;ctrlString@nbsp;=@nbsp;@quot;var@nbsp;ctrlMap@nbsp;=@nbsp;{@quot;;&#13;@nbsp;@nbsp;@nbsp;@nbsp;for@nbsp;(var@nbsp;key@nbsp;in@nbsp;ctrlMap)@nbsp;{&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;if@nbsp;(ctrlMap.hasOwnProperty(key))@nbsp;{&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;ctrlString@nbsp;+=@nbsp;@#146;@quot;@#146;@nbsp;+@nbsp;key@nbsp;+@nbsp;@#146;@quot;:@nbsp;@quot;@#146;@nbsp;+@nbsp;ctrlMap[key]@nbsp;+@nbsp;@#146;@quot;,@nbsp;@#146;;&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;}&#13;@nbsp;@nbsp;@nbsp;@nbsp;}&#13;@nbsp;@nbsp;@nbsp;@nbsp;//@nbsp;移除最后一个逗号和空格&#13;@nbsp;@nbsp;@nbsp;@nbsp;ctrlString@nbsp;=@nbsp;ctrlString.slice(0,@nbsp;-2);&#13;@nbsp;@nbsp;@nbsp;@nbsp;ctrlString@nbsp;+=@nbsp;@quot;};@quot;;&#13;@nbsp;@nbsp;@nbsp;@nbsp;//println(ctrlString);&#13;&#13;@nbsp;@nbsp;@nbsp;@nbsp;var@nbsp;htmlStrHeader@nbsp;=@nbsp;@quot;@lt;!DOCTYPE@nbsp;html@gt;\n\&#13;@lt;html@nbsp;lang=\@quot;en\@quot;@gt;\n\&#13;@lt;head@gt;\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@lt;meta@nbsp;charset=\@quot;UTF-8\@quot;@gt;\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@lt;meta@nbsp;name=\@quot;viewport\@quot;@nbsp;content=\@quot;width=device-width,@nbsp;initial-scale=1.0\@quot;@gt;\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@lt;title@gt;Dynamic@nbsp;Table@nbsp;Example@lt;/title@gt;\n\&#13;@lt;style@gt;\&#13;@nbsp;@nbsp;@nbsp;@nbsp;/*@nbsp;表格样式@nbsp;*/\&#13;@nbsp;@nbsp;@nbsp;@nbsp;.custom-table@nbsp;{\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;width:@nbsp;100%;\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;border-collapse:@nbsp;collapse;\&#13;@nbsp;@nbsp;@nbsp;@nbsp;}\&#13;@nbsp;@nbsp;@nbsp;@nbsp;.custom-table@nbsp;th,@nbsp;.custom-table@nbsp;td@nbsp;{\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;border:@nbsp;1px@nbsp;solid@nbsp;black;\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;text-align:@nbsp;center;\&#13;@nbsp;@nbsp;@nbsp;@nbsp;}\&#13;@nbsp;@nbsp;@nbsp;@nbsp;.custom-table@nbsp;th@nbsp;{\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;font-weight:@nbsp;bold;\&#13;@nbsp;@nbsp;@nbsp;@nbsp;}\&#13;@nbsp;@nbsp;@nbsp;@nbsp;/*@nbsp;合并单元格样式@nbsp;*/\&#13;@nbsp;@nbsp;@nbsp;@nbsp;.merged-cell@nbsp;{\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;background-color:@nbsp;%23ccc;\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;font-weight:@nbsp;bold;\&#13;@nbsp;@nbsp;@nbsp;@nbsp;}\&#13;@nbsp;@nbsp;@nbsp;@nbsp;/*@nbsp;添加虚线和浅灰色背景@nbsp;*/\&#13;@nbsp;@nbsp;@nbsp;@nbsp;.custom-table@nbsp;td.empty-cell@nbsp;{\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;border:@nbsp;0.5px@nbsp;dashed@nbsp;black;@nbsp;/*@nbsp;虚线边框样式，浅灰色@nbsp;*/\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;background-color:@nbsp;%23f2f2f2;@nbsp;/*@nbsp;浅灰色背景@nbsp;*/\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;text-align:@nbsp;center;@nbsp;/*@nbsp;文本居中@nbsp;*/\&#13;@nbsp;@nbsp;@nbsp;@nbsp;}\&#13;@nbsp;@nbsp;@nbsp;@nbsp;/*@nbsp;移除单元格默认的边框@nbsp;\&#13;@nbsp;@nbsp;@nbsp;@nbsp;.custom-table@nbsp;td.empty-cell:empty@nbsp;{\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;border:@nbsp;none;\&#13;@nbsp;@nbsp;@nbsp;@nbsp;}*/\&#13;@lt;/style@gt;\&#13;@lt;/head@gt;\n\&#13;@lt;body@gt;\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@lt;table@nbsp;class=\@quot;custom-table\@quot;@nbsp;id=\@quot;dynamic-table\@quot;@gt;\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@lt;tr@gt;\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@lt;th@nbsp;class=\@quot;merged-cell@nbsp;xx\@quot;@gt;一级@lt;/th@gt;\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@lt;th@nbsp;class=\@quot;merged-cell@nbsp;xx\@quot;@gt;二级@lt;/th@gt;\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@lt;th@nbsp;class=\@quot;merged-cell@nbsp;xx\@quot;@gt;三级@lt;/th@gt;\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@lt;th@nbsp;class=\@quot;merged-cell@nbsp;xx\@quot;@gt;四级@lt;/th@gt;\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@lt;th@nbsp;class=\@quot;merged-cell@nbsp;xx\@quot;@gt;五级@lt;/th@gt;\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@lt;th@nbsp;class=\@quot;merged-cell@nbsp;xx\@quot;@gt;六级@lt;/th@gt;\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@lt;/tr@gt;\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@lt;/table@gt;\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@lt;script@gt;\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@quot;+formattedArray+dictString+urlString+ctrlString+@quot;@nbsp;\&#13;//@nbsp;获取表格元素\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;var@nbsp;table@nbsp;=@nbsp;document.getElementById(\@quot;dynamic-table\@quot;);\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;//@nbsp;动态生成数据行并实现行合并@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;var@nbsp;prevRow@nbsp;=@nbsp;null;\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;for@nbsp;(var@nbsp;i@nbsp;=@nbsp;0;@nbsp;i@nbsp;@lt;@nbsp;data.length;@nbsp;i++)@nbsp;{\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;var@nbsp;row@nbsp;=@nbsp;document.createElement(\@quot;tr\@quot;);\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;for@nbsp;(var@nbsp;j@nbsp;=@nbsp;0;@nbsp;j@nbsp;@lt;@nbsp;data[i].length;@nbsp;j++)@nbsp;{\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;var@nbsp;cell@nbsp;=@nbsp;document.createElement(\@quot;td\@quot;);\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;var@nbsp;companyName@nbsp;=@nbsp;data[i][j];\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;if@nbsp;(urls.hasOwnProperty(companyName))@nbsp;{\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;var@nbsp;docid@nbsp;=@nbsp;urls[companyName];@nbsp;//@nbsp;使用正确的键名@nbsp;companyName@nbsp;\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;var@nbsp;controlRatio@nbsp;=@nbsp;ctrlMap[companyName]@nbsp;||@nbsp;\@quot;\@quot;;\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;var@nbsp;link@nbsp;=@nbsp;document.createElement(\@quot;a\@quot;);\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;link.href@nbsp;=@nbsp;urls[companyName];\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;link.target@nbsp;=@nbsp;\@quot;_blank\@quot;;\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;link.textContent@nbsp;=@nbsp;companyName;\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;if@nbsp;(controlRatio!=@#146;%@#146;){\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;link.textContent+=\@quot;(\@quot;+controlRatio+\@quot;)\@quot;;\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;}\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;cell.appendChild(link);\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;}@nbsp;else@nbsp;{\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;cell.textContent@nbsp;=@nbsp;companyName;\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;if@nbsp;(controlRatio!=@#146;%@#146;){\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;cell.textContent+=\@quot;(\@quot;+controlRatio+\@quot;)\@quot;;\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;}\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;}\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;row.appendChild(cell);\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;}\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;table.appendChild(row);\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;}\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;//从右下至左上，合并相同的列\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;for@nbsp;(var@nbsp;i@nbsp;=@nbsp;data.length;@nbsp;i@nbsp;@gt;@nbsp;1;@nbsp;i--)@nbsp;{\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;var@nbsp;curRow@nbsp;=@nbsp;table.rows[i];\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;var@nbsp;prevRow@nbsp;=@nbsp;table.rows[i@nbsp;-@nbsp;1];\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;for@nbsp;(var@nbsp;j@nbsp;=@nbsp;Math.min(curRow.cells.length,@nbsp;prevRow.cells.length)@nbsp;-@nbsp;1;@nbsp;j@nbsp;@gt;=@nbsp;0;@nbsp;j--)@nbsp;{\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;if@nbsp;(curRow.cells[j]@nbsp;&amp;&amp;@nbsp;prevRow.cells[j]@nbsp;&amp;&amp;@nbsp;curRow.cells[j].innerText@nbsp;==@nbsp;prevRow.cells[j].innerText@nbsp;&amp;&amp;@nbsp;curRow.cells[j].innerText!=\@quot;\@quot;)@nbsp;{\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;//@nbsp;如果该列相等，则合并：prevRow的cell的rowSpan增加，标记删除当前节点\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;prevRow.cells[j].rowSpan@nbsp;+=@nbsp;curRow.cells[j].rowSpan;\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;curRow.deleteCell(j);\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;}\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;}\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;if@nbsp;(curRow.cells[curRow.cells.length-1].innerText.substring(0,@nbsp;curRow.cells[curRow.cells.length-1].innerText.indexOf(@#146;(@#146;)).trim()@nbsp;in@nbsp;NoSubCompanyMap){\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;console.log(curRow.cells[curRow.cells.length-1].innerText,NoSubCompanyMap[curRow.cells[curRow.cells.length-1].innerText]);\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;var@nbsp;count=NoSubCompanyMap[curRow.cells[curRow.cells.length-1].innerText.substring(0,@nbsp;curRow.cells[curRow.cells.length-1].innerText.indexOf(@#146;(@#146;)).trim()];\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;while(count@lt;6){\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;var@nbsp;cell@nbsp;=@nbsp;document.createElement(\@quot;td\@quot;);\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;cell.className@nbsp;=@nbsp;\@quot;empty-cell\@quot;;\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;//cell.TextContent@nbsp;=@nbsp;\@quot;\@quot;;\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;curRow.appendChild(cell);\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;count+=1;\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;}\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;}\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;if@nbsp;(curRow.cells[curRow.cells.length-1].innerText@nbsp;in@nbsp;NoSubCompanyMap){\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;console.log(curRow.cells[curRow.cells.length-1].innerText,NoSubCompanyMap[curRow.cells[curRow.cells.length-1].innerText]);\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;var@nbsp;count=NoSubCompanyMap[curRow.cells[curRow.cells.length-1].innerText];\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;while(count@lt;6){\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;var@nbsp;cell@nbsp;=@nbsp;document.createElement(\@quot;td\@quot;);\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;cell.className@nbsp;=@nbsp;\@quot;empty-cell\@quot;;\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;//cell.TextContent@nbsp;=@nbsp;\@quot;\@quot;;\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;curRow.appendChild(cell);\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;count+=1;\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;}\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;}\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;@nbsp;}\n\&#13;@nbsp;@nbsp;@nbsp;@nbsp;@lt;/script@gt;\n\&#13;@lt;/body@gt;\n\&#13;@lt;/html@gt;@quot;;&#13;&#13;@nbsp;@nbsp;return@nbsp;htmlStrHeader;&#13;})();" style="display: inline-block; width: 100%; border-left: 5px solid rgb(13, 179, 166); border-top-color: rgb(13, 179, 166); border-right-color: rgb(13, 179, 166); border-bottom-color: rgb(13, 179, 166); background-color: rgb(235, 248, 251); position: relative; vertical-align: top;"><div style="padding: 5px 0;line-height: 20px;color: #3d464d;font-weight: 600;">
        <span class="baseLabel-title" style="font-size: 14px;color: #3d464d;">表格显示</span>
        </div><div class="baseCon fieldId" fieldid="1ba7ccc7-4d25-f658-c76c-d7d2e98a2ea0" style="height: 30px;">
        <img src="images/calctextField.png"></div><div class="delete"><i class="btn-delete" title="删除"></i></div></div><div name="占位1" id="d3338b82-fe69-9932-cd96-6f9e163c9490" draggable="true" scope="calctextField" myselfrows="100" layout="horizontal" calculateonrefresh="false" valuescript="(function(){&#13;var@nbsp;html=@quot;@lt;o-action@nbsp;action-type=\@quot;opendocument\@quot;@nbsp;formid=\@quot;__goBsOFp5lEYiwNUUdF3\@quot;@nbsp;docid=\@quot;FaSMYThpEV9vcXIzUTK--__goBsOFp5lEYiwNUUdF3\@quot;@nbsp;appid=\@quot;__avYbKPJJjObzoPrV2er\@quot;@nbsp;open-type=\@quot;open-tab\@quot;@nbsp;isrefresh=\@quot;true\@quot;@nbsp;dialog-width=\@quot;100%\@quot;@nbsp;dialog-height=\@quot;100%\@quot;@nbsp;exparams=\@quot;&amp;type=1&amp;test=2\@quot;@nbsp;parentid=\@quot;__cqu5flKjT8E35djAmXY\@quot;@gt;东莞市交通投资集团有限公司@lt;/o-action@gt;@quot;&#13;return@nbsp;html;&#13;})()" style="display: inline-block; width: 100%; border-left: 5px solid rgb(255, 255, 255); border-top-color: rgb(255, 255, 255); border-right-color: rgb(255, 255, 255); border-bottom-color: rgb(255, 255, 255); background-color: rgb(255, 255, 255); position: relative; vertical-align: top;"><div style="padding: 5px 0;line-height: 20px;color: #3d464d;font-weight: 600;">
        <span class="baseLabel-title" style="font-size: 14px;color: #3d464d;">占位1</span>
        </div><div class="baseCon fieldId" fieldid="d3338b82-fe69-9932-cd96-6f9e163c9490" style="height: 30px;">
        <img src="images/calctextField.png"></div><div class="delete d-none"><i class="btn-delete" title="删除"></i></div></div><div name="占位2" id="159f4b4c-9487-efe3-de17-3a3bd9fdfa0d" draggable="true" scope="calctextField" myselfrows="100" layout="horizontal" calculateonrefresh="false" valuescript="" style="display: inline-block; width: 100%; border-left: 5px solid rgb(255, 255, 255); border-top-color: rgb(255, 255, 255); border-right-color: rgb(255, 255, 255); border-bottom-color: rgb(255, 255, 255); background-color: rgb(255, 255, 255); position: relative; vertical-align: top;"><div style="padding: 5px 0;line-height: 20px;color: #3d464d;font-weight: 600;">
        <span class="baseLabel-title" style="font-size: 14px;color: #3d464d;">占位2</span>
        </div><div class="baseCon fieldId" fieldid="159f4b4c-9487-efe3-de17-3a3bd9fdfa0d" style="height: 30px;">
        <img src="images/calctextField.png"></div><div class="delete d-none"><i class="btn-delete" title="删除"></i></div></div></div>]]></templatecontext>
  <type>1</type>
  <styleId>__DTYlCxzcY02mLZbuuE9</styleId>
  <showLog>false</showLog>
  <showLogType>default</showLogType>
  <openComment>false</openComment>
  <commentTitleScript><![CDATA[]]></commentTitleScript>
  <commentFlagScript><![CDATA[]]></commentFlagScript>
  <commentHiddenScrtipt><![CDATA[]]></commentHiddenScrtipt>
  <commentExecuteScript><![CDATA[]]></commentExecuteScript>
  <recordMode>every</recordMode>
  <recordModeScript><![CDATA[]]></recordModeScript>
  <showType>new</showType>
  <showWaterMark>false</showWaterMark>
  <waterMarkScript></waterMarkScript>
  <version>1</version>
  <isopenablescript><![CDATA[]]></isopenablescript>
  <iseditablescript><![CDATA[]]></iseditablescript>
  <mappingStr><![CDATA[{"formName":"股权架构信息_表格显示","tableName":"","columnMappings":[]}]]></mappingStr>
  <orderno>1</orderno>
  <permissionType>public</permissionType>
  <layoutType>horizontal</layoutType>
</form>